---
- hosts: machine
  become: true
  gather_facts: true
  tasks:

   - name: Install aptitude using apt
     apt:
       name: aptitude
       state: latest
       update_cache: yes
       force_apt_get: yes

   - name: Install required system packages
     apt:
       pkg:
       - ca-certificates
       - curl
       - software-properties-common
       - python-pip
       - virtualenv
       - python3-setuptools

   - name: Add docker gpg apt key
     apt_key:
       url: https://download.docker.com/linux/ubuntu/gpg
       state: present

   - name: Add docker repository
     apt_repository:
       repo: deb https://download.docker.com/linux/ubuntu bionic stable
       state: present

   - name: Update apt and install docker-ce
     apt:
       update_cache: yes
       name: docker-ce
       state: latest

   - name: Install docker module for python
     pip:
       name: docker

   - name: Start and enable docker
     service:
       name: docker
       state: started
       enabled: yes

   - name: Add user to Docker group
     user:
       name: student
       groups: docker
       append: yes


